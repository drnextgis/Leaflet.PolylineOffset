<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <title>Leaflet Polyline Offset - Amsterdam Metro Network</title>

    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
    <style>
      * { margin: 0; padding: 0; }
      html, body { height: 100%; }
      #map { width:100%; height:100%; }
    </style>

    <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet-src.js"></script>
    <script src="../leaflet.polylineoffset.js"></script>
    <script src="../contrib/jsts/lib/javascript.util.js"></script>
    <script src="../contrib/jsts/lib/jsts.js"></script>
    <script>
      window.onload = function () {
        var map = new L.Map('map', {
          center: [52.3367, 4.9032],
          zoom: 13,
          layers: [
            L.tileLayer('http://{s}.tile.openstreetmap.se/hydda/full/{z}/{x}/{y}.png', {
              minZoom: 0,
              maxZoom: 18,
              attribution: 'Tiles courtesy of <a href="http://openstreetmap.se/" target="_blank">OpenStreetMap Sweden</a> &mdash; Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>'
            })
          ]
        });

        var geoJson = {
          "type": "FeatureCollection",
          "crs": { "type": "name", "properties": { "name": "urn:ogc:def:crs:OGC:1.3:CRS84" } },

          "features": [
          { "type": "Feature", "properties": { "lines": "1" }, "geometry": { "type": "LineString", "coordinates": [ [ 4.85146, 52.39516 ], [ 4.84724, 52.39519 ], [ 4.84471, 52.39519 ], [ 4.84443, 52.39516 ], [ 4.84395, 52.39509 ], [ 4.84346, 52.39497 ], [ 4.84292, 52.39479 ], [ 4.84243, 52.39458 ], [ 4.84207, 52.3944 ], [ 4.84143, 52.39403 ], [ 4.84085, 52.3937 ], [ 4.84022, 52.39327 ], [ 4.83991, 52.39301 ], [ 4.83967, 52.39275 ], [ 4.83933, 52.39229 ], [ 4.83912, 52.39192 ], [ 4.83901, 52.39158 ], [ 4.83894, 52.39131 ], [ 4.83891, 52.39088 ], [ 4.83889, 52.3904 ], [ 4.83888, 52.3898 ], [ 4.83889, 52.38909 ], [ 4.8389, 52.38836 ], [ 4.83894, 52.38775 ], [ 4.83898, 52.3873 ], [ 4.83904, 52.38686 ], [ 4.8391, 52.38654 ], [ 4.83915, 52.38626 ], [ 4.83929, 52.38574 ], [ 4.83948, 52.38518 ], [ 4.83963, 52.3846 ], [ 4.83969, 52.38441 ], [ 4.83973, 52.3841 ], [ 4.83973, 52.38384 ], [ 4.83972, 52.38364 ], [ 4.83969, 52.38345 ], [ 4.83958, 52.38308 ], [ 4.8395, 52.38282 ], [ 4.83938, 52.38252 ], [ 4.83895, 52.38148 ], [ 4.83883, 52.38117 ], [ 4.83868, 52.38075 ], [ 4.83805, 52.37918 ], [ 4.83767, 52.37839 ], [ 4.83747, 52.37794 ], [ 4.83711, 52.37712 ], [ 4.83647, 52.3756 ], [ 4.83617, 52.37486 ], [ 4.83561, 52.37345 ], [ 4.83494, 52.37177 ], [ 4.83463, 52.37089 ], [ 4.83443, 52.36993 ], [ 4.83426, 52.36902 ], [ 4.83406, 52.36783 ], [ 4.83404, 52.3675 ], [ 4.83399, 52.36665 ], [ 4.83395, 52.36504 ], [ 4.83395, 52.36389 ], [ 4.83398, 52.36327 ], [ 4.83405, 52.36167 ], [ 4.8341, 52.36064 ], [ 4.83413, 52.36019 ], [ 4.83421, 52.35948 ], [ 4.83424, 52.35911 ], [ 4.83435, 52.35834 ], [ 4.83438, 52.35749 ], [ 4.83432, 52.35619 ], [ 4.8343, 52.35594 ], [ 4.83424, 52.3546 ], [ 4.83425, 52.3533 ], [ 4.83427, 52.35285 ], [ 4.83433, 52.3514 ], [ 4.83432, 52.35028 ], [ 4.83435, 52.34917 ], [ 4.8344, 52.34768 ], [ 4.83451, 52.34614 ], [ 4.83457, 52.34458 ], [ 4.83464, 52.34384 ], [ 4.83469, 52.34344 ], [ 4.83482, 52.34247 ], [ 4.83494, 52.3418 ], [ 4.83503, 52.34149 ], [ 4.83506, 52.34137 ], [ 4.83527, 52.34095 ], [ 4.8356, 52.34045 ], [ 4.83583, 52.3402 ], [ 4.83621, 52.33984 ], [ 4.83652, 52.33959 ], [ 4.83699, 52.33932 ], [ 4.83758, 52.33899 ], [ 4.8381, 52.33875 ], [ 4.83931, 52.33842 ], [ 4.84123, 52.33805 ], [ 4.84262, 52.33785 ], [ 4.84381, 52.33776 ], [ 4.84487, 52.33775 ], [ 4.84634, 52.33781 ], [ 4.84743, 52.33788 ], [ 4.84937, 52.33798 ], [ 4.85069, 52.33802 ], [ 4.85134, 52.33805 ], [ 4.85212, 52.33808 ], [ 4.85332, 52.33813 ], [ 4.8544, 52.33819 ], [ 4.85556, 52.33827 ], [ 4.85734, 52.33839 ], [ 4.85972, 52.33852 ], [ 4.86161, 52.33864 ], [ 4.86473, 52.33878 ], [ 4.86789, 52.3389 ], [ 4.86996, 52.33899 ], [ 4.87221, 52.33905 ] ] } },
          { "type": "Feature", "properties": { "lines": "2" }, "geometry": { "type": "LineString", "coordinates": [ [ 4.83091, 52.27473 ], [ 4.83185, 52.27589 ], [ 4.83235, 52.27661 ], [ 4.83266, 52.27703 ], [ 4.83304, 52.27757 ], [ 4.83335, 52.27799 ], [ 4.83345, 52.27821 ], [ 4.8335, 52.27838 ], [ 4.83342, 52.27868 ], [ 4.83331, 52.27897 ], [ 4.83301, 52.27948 ], [ 4.83263, 52.28015 ], [ 4.83216, 52.28098 ], [ 4.83208, 52.28121 ], [ 4.83206, 52.28146 ], [ 4.83212, 52.28175 ], [ 4.8324, 52.28216 ], [ 4.83283, 52.28275 ], [ 4.8333, 52.28334 ], [ 4.83349, 52.28355 ], [ 4.83373, 52.28374 ], [ 4.83397, 52.28388 ], [ 4.83422, 52.284 ], [ 4.83464, 52.28418 ], [ 4.83496, 52.28428 ], [ 4.83534, 52.28437 ], [ 4.83584, 52.28442 ], [ 4.83644, 52.28444 ], [ 4.83699, 52.2844 ], [ 4.83785, 52.28428 ], [ 4.83896, 52.28412 ], [ 4.83961, 52.28402 ], [ 4.84, 52.28398 ], [ 4.8405, 52.28392 ], [ 4.84104, 52.28385 ], [ 4.8419, 52.28375 ], [ 4.84264, 52.28363 ], [ 4.84337, 52.28351 ], [ 4.84418, 52.2834 ], [ 4.84534, 52.28324 ], [ 4.8463, 52.2831 ], [ 4.84679, 52.28301 ], [ 4.84706, 52.2829 ], [ 4.84732, 52.28274 ], [ 4.84874, 52.28139 ], [ 4.84918, 52.28105 ], [ 4.84957, 52.28088 ], [ 4.85015, 52.28077 ], [ 4.85121, 52.28063 ], [ 4.8526, 52.28044 ], [ 4.85349, 52.28032 ], [ 4.85506, 52.28011 ], [ 4.8554, 52.2801 ], [ 4.85587, 52.28014 ], [ 4.85615, 52.28019 ], [ 4.85638, 52.2803 ], [ 4.85659, 52.28044 ], [ 4.8571, 52.28092 ], [ 4.85743, 52.28133 ], [ 4.8578, 52.28194 ], [ 4.85793, 52.28213 ], [ 4.85875, 52.28356 ], [ 4.85891, 52.28381 ], [ 4.85907, 52.28413 ], [ 4.8595, 52.28474 ], [ 4.85983, 52.28517 ], [ 4.86021, 52.28572 ], [ 4.86036, 52.28585 ], [ 4.86078, 52.28621 ], [ 4.86101, 52.2864 ], [ 4.86126, 52.28677 ], [ 4.86174, 52.28754 ], [ 4.86228, 52.28842 ], [ 4.86259, 52.28881 ], [ 4.86327, 52.28964 ], [ 4.86368, 52.29016 ], [ 4.86372, 52.29023 ], [ 4.86381, 52.29033 ], [ 4.86448, 52.29137 ], [ 4.86518, 52.29251 ], [ 4.86592, 52.29369 ], [ 4.86638, 52.29444 ], [ 4.86667, 52.29485 ], [ 4.86706, 52.29549 ], [ 4.86758, 52.29629 ], [ 4.86807, 52.29706 ], [ 4.86847, 52.29771 ], [ 4.86888, 52.29839 ], [ 4.86935, 52.29913 ], [ 4.86989, 52.29999 ], [ 4.87044, 52.30084 ], [ 4.87073, 52.30127 ], [ 4.87119, 52.30198 ], [ 4.87158, 52.30257 ], [ 4.87196, 52.30317 ], [ 4.8722, 52.30374 ], [ 4.87229, 52.30404 ], [ 4.87236, 52.3044 ], [ 4.87238, 52.30461 ], [ 4.87243, 52.30514 ], [ 4.87246, 52.30604 ], [ 4.8725, 52.30694 ], [ 4.87251, 52.30721 ], [ 4.87251, 52.30779 ], [ 4.87256, 52.30894 ], [ 4.87257, 52.3098 ], [ 4.87256, 52.31055 ], [ 4.87251, 52.31116 ], [ 4.87236, 52.31192 ], [ 4.87223, 52.31246 ], [ 4.8719, 52.31324 ], [ 4.87183, 52.31341 ], [ 4.87148, 52.31412 ], [ 4.87122, 52.31465 ], [ 4.87081, 52.31548 ], [ 4.87063, 52.31585 ], [ 4.87056, 52.31598 ], [ 4.87052, 52.31608 ], [ 4.87024, 52.31669 ], [ 4.86986, 52.31758 ], [ 4.8697, 52.31795 ], [ 4.86955, 52.31844 ], [ 4.86942, 52.31894 ], [ 4.86936, 52.31926 ], [ 4.86926, 52.31989 ], [ 4.86924, 52.32015 ], [ 4.86919, 52.321 ], [ 4.86919, 52.32185 ], [ 4.86916, 52.32246 ], [ 4.86911, 52.32305 ], [ 4.8691, 52.32314 ], [ 4.86905, 52.32391 ], [ 4.86901, 52.32471 ], [ 4.86899, 52.32533 ], [ 4.86895, 52.32591 ], [ 4.86894, 52.32649 ], [ 4.86892, 52.32707 ], [ 4.8689, 52.32763 ], [ 4.86888, 52.32822 ], [ 4.86887, 52.3288 ], [ 4.86886, 52.32938 ], [ 4.86887, 52.32995 ], [ 4.86888, 52.33052 ], [ 4.86889, 52.3311 ], [ 4.86889, 52.33167 ], [ 4.86889, 52.33225 ], [ 4.86887, 52.33283 ], [ 4.86886, 52.33341 ], [ 4.86885, 52.33398 ], [ 4.86883, 52.33456 ], [ 4.86883, 52.33475 ], [ 4.86884, 52.33512 ], [ 4.86884, 52.33542 ], [ 4.86881, 52.33621 ], [ 4.86885, 52.3368 ], [ 4.86892, 52.3371 ], [ 4.86904, 52.33731 ], [ 4.86917, 52.3375 ], [ 4.86939, 52.33773 ], [ 4.86968, 52.33798 ], [ 4.87002, 52.33822 ], [ 4.87061, 52.33856 ], [ 4.87128, 52.33881 ], [ 4.87167, 52.33893 ], [ 4.87221, 52.33905 ] ] } },
          { "type": "Feature", "properties": { "lines": "3" }, "geometry": { "type": "LineString", "coordinates": [ [ 4.98491, 52.31065 ], [ 4.9844, 52.31122 ], [ 4.98352, 52.31216 ], [ 4.98281, 52.31292 ], [ 4.98217, 52.31364 ], [ 4.98145, 52.31442 ], [ 4.98107, 52.31482 ], [ 4.97966, 52.3164 ], [ 4.97918, 52.31694 ], [ 4.97829, 52.3179 ], [ 4.97743, 52.31883 ], [ 4.9765, 52.31985 ], [ 4.97535, 52.32111 ], [ 4.97421, 52.32237 ], [ 4.97314, 52.32354 ], [ 4.97302, 52.32366 ], [ 4.97201, 52.32478 ], [ 4.97156, 52.3253 ], [ 4.97075, 52.32607 ], [ 4.97014, 52.3266 ], [ 4.96997, 52.32673 ], [ 4.96967, 52.32696 ], [ 4.96923, 52.32723 ], [ 4.96851, 52.32763 ], [ 4.9672, 52.32838 ], [ 4.96563, 52.32927 ], [ 4.96491, 52.32968 ], [ 4.96329, 52.33054 ], [ 4.96264, 52.33081 ], [ 4.96204, 52.33099 ], [ 4.96164, 52.33107 ], [ 4.96125, 52.33111 ], [ 4.96066, 52.33114 ], [ 4.96022, 52.33114 ], [ 4.95984, 52.33111 ], [ 4.95951, 52.33107 ], [ 4.95921, 52.33102 ], [ 4.95891, 52.33095 ], [ 4.95824, 52.33082 ], [ 4.95789, 52.33072 ], [ 4.95666, 52.33032 ], [ 4.95482, 52.32975 ], [ 4.95391, 52.32947 ], [ 4.95276, 52.32909 ], [ 4.95165, 52.3287 ], [ 4.94994, 52.32811 ], [ 4.94911, 52.3278 ], [ 4.94776, 52.32727 ], [ 4.94636, 52.32677 ], [ 4.94461, 52.32617 ], [ 4.94354, 52.32569 ], [ 4.94282, 52.32533 ], [ 4.94191, 52.32489 ], [ 4.94142, 52.32464 ], [ 4.94118, 52.32452 ], [ 4.94069, 52.32436 ], [ 4.94011, 52.3242 ], [ 4.9397, 52.32411 ], [ 4.93915, 52.32404 ], [ 4.9386, 52.324 ], [ 4.9381, 52.324 ], [ 4.93764, 52.32402 ], [ 4.93703, 52.32413 ], [ 4.93621, 52.32435 ], [ 4.93579, 52.32452 ], [ 4.93516, 52.32488 ], [ 4.93457, 52.3253 ] ] } },
          { "type": "Feature", "properties": { "lines": "1,4" }, "geometry": { "type": "LineString", "coordinates": [ [ 4.98998, 52.29635 ], [ 4.98914, 52.29633 ], [ 4.98711, 52.29634 ], [ 4.98607, 52.29633 ], [ 4.98446, 52.29632 ], [ 4.98104, 52.29631 ], [ 4.97964, 52.29629 ], [ 4.97905, 52.29628 ], [ 4.97865, 52.29625 ], [ 4.97756, 52.29615 ], [ 4.97651, 52.296 ], [ 4.97513, 52.29577 ], [ 4.97419, 52.29561 ], [ 4.97197, 52.29524 ], [ 4.97056, 52.29497 ], [ 4.97, 52.29487 ], [ 4.96928, 52.29473 ], [ 4.96803, 52.29452 ], [ 4.96746, 52.29442 ], [ 4.96709, 52.29438 ], [ 4.9667, 52.29434 ], [ 4.96635, 52.29432 ], [ 4.96591, 52.29432 ], [ 4.96562, 52.29433 ], [ 4.9653, 52.29435 ], [ 4.96487, 52.29442 ], [ 4.96426, 52.29455 ], [ 4.96396, 52.29464 ], [ 4.96339, 52.29485 ], [ 4.96297, 52.29509 ], [ 4.9627, 52.29526 ], [ 4.96231, 52.29559 ], [ 4.96184, 52.29611 ], [ 4.96118, 52.29684 ], [ 4.96044, 52.29766 ], [ 4.9602, 52.29792 ], [ 4.95961, 52.29859 ], [ 4.95869, 52.29961 ], [ 4.95765, 52.30073 ], [ 4.95694, 52.3015 ], [ 4.95574, 52.3028 ], [ 4.95451, 52.30413 ], [ 4.9536, 52.30513 ], [ 4.95278, 52.30604 ], [ 4.95208, 52.30681 ], [ 4.95132, 52.30765 ], [ 4.95014, 52.3089 ], [ 4.9491, 52.31003 ], [ 4.94818, 52.31104 ], [ 4.94735, 52.31195 ], [ 4.94705, 52.31231 ], [ 4.94635, 52.31311 ], [ 4.94528, 52.3142 ], [ 4.94485, 52.31466 ], [ 4.94405, 52.31553 ], [ 4.94362, 52.31598 ], [ 4.94335, 52.31629 ], [ 4.9429, 52.31682 ], [ 4.94239, 52.31742 ], [ 4.94198, 52.31785 ], [ 4.94113, 52.31878 ], [ 4.94041, 52.31952 ], [ 4.93973, 52.32028 ], [ 4.93903, 52.32107 ], [ 4.93831, 52.32184 ], [ 4.9379, 52.32226 ], [ 4.93747, 52.32268 ], [ 4.9371, 52.32304 ], [ 4.93652, 52.32358 ], [ 4.93609, 52.32398 ], [ 4.93457, 52.3253 ] ] } },
          { "type": "Feature", "properties": { "lines": "1,2" }, "geometry": { "type": "LineString", "coordinates": [ [ 4.87221, 52.33905 ], [ 4.87326, 52.33906 ], [ 4.87428, 52.33909 ], [ 4.87522, 52.33911 ], [ 4.8759, 52.33913 ], [ 4.87661, 52.33914 ], [ 4.87781, 52.3392 ], [ 4.87876, 52.33923 ], [ 4.87967, 52.33926 ], [ 4.88081, 52.33931 ], [ 4.88164, 52.33932 ], [ 4.88212, 52.3393 ], [ 4.88256, 52.33927 ], [ 4.88327, 52.33921 ], [ 4.88423, 52.33909 ], [ 4.88515, 52.33893 ], [ 4.88579, 52.33879 ], [ 4.88678, 52.33854 ], [ 4.88715, 52.33845 ], [ 4.88775, 52.3383 ], [ 4.88812, 52.33818 ], [ 4.88862, 52.33799 ], [ 4.88895, 52.33783 ], [ 4.88946, 52.33759 ], [ 4.89004, 52.33729 ], [ 4.89065, 52.33698 ], [ 4.89163, 52.33649 ], [ 4.89246, 52.33604 ], [ 4.8935, 52.33547 ], [ 4.89428, 52.33506 ], [ 4.895, 52.33468 ], [ 4.89545, 52.33444 ], [ 4.89633, 52.33401 ], [ 4.89699, 52.3337 ], [ 4.89754, 52.33343 ], [ 4.89819, 52.33313 ], [ 4.89878, 52.33284 ], [ 4.89896, 52.33276 ], [ 4.89936, 52.33256 ], [ 4.89987, 52.33233 ], [ 4.90043, 52.33205 ], [ 4.90096, 52.3318 ], [ 4.90138, 52.3316 ], [ 4.90191, 52.33134 ], [ 4.90291, 52.33086 ], [ 4.90378, 52.33045 ], [ 4.90408, 52.33033 ], [ 4.90436, 52.33023 ], [ 4.90484, 52.33009 ], [ 4.90549, 52.32999 ], [ 4.90616, 52.32991 ], [ 4.90663, 52.3299 ], [ 4.90728, 52.32995 ], [ 4.90799, 52.33001 ], [ 4.90897, 52.33011 ], [ 4.91034, 52.33025 ], [ 4.91139, 52.33036 ], [ 4.91193, 52.33042 ], [ 4.91291, 52.33052 ], [ 4.91341, 52.33057 ], [ 4.91413, 52.33068 ], [ 4.9144, 52.33074 ], [ 4.91561, 52.33106 ], [ 4.91673, 52.33138 ], [ 4.91776, 52.3317 ], [ 4.91892, 52.33205 ], [ 4.9193, 52.33217 ] ] } },
          { "type": "Feature", "properties": { "lines": "1,3,4" }, "geometry": { "type": "LineString", "coordinates": [ [ 4.93457, 52.3253 ], [ 4.93451, 52.32535 ], [ 4.93401, 52.32574 ], [ 4.93345, 52.32627 ], [ 4.93295, 52.32679 ], [ 4.93257, 52.32721 ], [ 4.93217, 52.32765 ], [ 4.93149, 52.32839 ], [ 4.93051, 52.32946 ], [ 4.92934, 52.33074 ], [ 4.92867, 52.33144 ], [ 4.92727, 52.33288 ] ] } },
          { "type": "Feature", "properties": { "lines": "2,3,4" }, "geometry": { "type": "LineString", "coordinates": [ [ 4.92258, 52.33808 ], [ 4.92154, 52.33939 ], [ 4.9206, 52.34081 ], [ 4.92016, 52.34152 ], [ 4.91963, 52.3424 ], [ 4.91935, 52.34288 ], [ 4.91906, 52.34339 ], [ 4.91889, 52.34394 ], [ 4.9187, 52.34447 ], [ 4.91859, 52.34474 ], [ 4.91843, 52.34502 ], [ 4.91815, 52.34548 ], [ 4.91781, 52.34603 ], [ 4.91759, 52.34639 ], [ 4.91708, 52.34719 ], [ 4.91685, 52.34757 ], [ 4.91645, 52.34827 ], [ 4.91621, 52.34865 ], [ 4.91608, 52.34881 ], [ 4.91581, 52.34911 ], [ 4.91549, 52.34946 ], [ 4.91516, 52.34978 ], [ 4.91467, 52.35031 ], [ 4.91439, 52.3506 ], [ 4.91402, 52.35115 ], [ 4.9137, 52.35161 ], [ 4.91315, 52.35241 ], [ 4.91258, 52.35341 ], [ 4.9123, 52.35392 ], [ 4.91176, 52.35494 ], [ 4.9115, 52.35542 ], [ 4.91099, 52.3562 ], [ 4.91064, 52.35676 ], [ 4.91036, 52.35721 ], [ 4.91002, 52.35777 ], [ 4.90969, 52.35834 ], [ 4.90947, 52.35871 ], [ 4.90907, 52.35934 ], [ 4.90867, 52.35998 ], [ 4.90846, 52.36034 ], [ 4.90823, 52.36072 ], [ 4.90791, 52.36127 ], [ 4.90738, 52.36222 ], [ 4.907, 52.36287 ], [ 4.90674, 52.36329 ], [ 4.90612, 52.36434 ], [ 4.90584, 52.36478 ], [ 4.90545, 52.36542 ], [ 4.90518, 52.36572 ], [ 4.90469, 52.36606 ], [ 4.9039, 52.36639 ], [ 4.90294, 52.36679 ], [ 4.9019, 52.36715 ], [ 4.90117, 52.36751 ], [ 4.90078, 52.36788 ], [ 4.90054, 52.36866 ], [ 4.90051, 52.36877 ], [ 4.90043, 52.36935 ], [ 4.90036, 52.36969 ], [ 4.9004, 52.37028 ], [ 4.90057, 52.37083 ], [ 4.90078, 52.37127 ], [ 4.90109, 52.37174 ], [ 4.90145, 52.37213 ], [ 4.90166, 52.37237 ], [ 4.9024, 52.37299 ], [ 4.90266, 52.37319 ], [ 4.90314, 52.37365 ], [ 4.90332, 52.37392 ], [ 4.90345, 52.37432 ], [ 4.90356, 52.37496 ], [ 4.90352, 52.37538 ], [ 4.9034, 52.37574 ], [ 4.90328, 52.37593 ], [ 4.90306, 52.37613 ], [ 4.90236, 52.37671 ], [ 4.90215, 52.37686 ], [ 4.90202, 52.37694 ], [ 4.90159, 52.37721 ], [ 4.90069, 52.37764 ] ] } },
          { "type": "Feature", "properties": { "lines": "1" }, "geometry": { "type": "LineString", "coordinates": [ [ 4.9193, 52.33217 ], [ 4.92011, 52.33236 ], [ 4.92106, 52.33262 ], [ 4.92243, 52.33313 ], [ 4.92297, 52.33332 ], [ 4.92347, 52.33344 ], [ 4.92403, 52.33351 ], [ 4.92453, 52.33355 ], [ 4.92545, 52.33349 ], [ 4.92665, 52.33314 ], [ 4.92727, 52.33288 ] ] } },
          { "type": "Feature", "properties": { "lines": "2" }, "geometry": { "type": "LineString", "coordinates": [ [ 4.92265, 52.33803 ], [ 4.92296, 52.33761 ], [ 4.92312, 52.33738 ], [ 4.92333, 52.33703 ], [ 4.92348, 52.33675 ], [ 4.92354, 52.33653 ], [ 4.92361, 52.33626 ], [ 4.92365, 52.33599 ], [ 4.92368, 52.33564 ], [ 4.92369, 52.33535 ], [ 4.92367, 52.33501 ], [ 4.92364, 52.33485 ], [ 4.92357, 52.33463 ], [ 4.92349, 52.33438 ], [ 4.92327, 52.33397 ], [ 4.92308, 52.33378 ], [ 4.92288, 52.33359 ], [ 4.92268, 52.33344 ], [ 4.92244, 52.33328 ], [ 4.92202, 52.33305 ], [ 4.92139, 52.3328 ], [ 4.92072, 52.33259 ], [ 4.9193, 52.33217 ] ] } },
          { "type": "Feature", "properties": { "lines": "3,4" }, "geometry": { "type": "LineString", "coordinates": [ [ 4.92727, 52.33288 ], [ 4.92579, 52.33454 ], [ 4.92455, 52.33594 ], [ 4.92326, 52.33734 ], [ 4.92265, 52.33803 ] ] } }
          ]
        };

        var lineWeight = 6;
        var lineColors = ['#ffffff','#44b85c', '#08f', '#f58631', '#ed1b35'];

        // manage overlays in groups to ease superposition order
        var outlines = L.layerGroup();
        var lineBg = L.layerGroup();
        var busLines = L.layerGroup();
        var busStops = L.layerGroup();

        var ends = [];
        function addStop(ll) {
          for(var i=0, found=false; i<ends.length && !found; i++) {
            found = (ends[i].lat == ll.lat && ends[i].lng == ll.lng);
          }
          if(!found) {
            ends.push(ll);
          }
        }

        var lineSegment, linesOnSegment, segmentCoords, segmentWidth;
        geoJson.features.forEach(function(lineSegment) {
          segmentCoords = L.GeoJSON.coordsToLatLngs(lineSegment.geometry.coordinates, 0);

          linesOnSegment = lineSegment.properties.lines.split(',');
          segmentWidth = linesOnSegment.length * (lineWeight + 1);

          L.polyline(segmentCoords, {
            color: '#000',
            weight: segmentWidth + 5,
            opacity: 1
          }).addTo(outlines);

          L.polyline(segmentCoords, {
            color: '#fff',
            weight: segmentWidth + 3,
            opacity: 1
          }).addTo(lineBg);

          for(var j=0;j<linesOnSegment.length;j++) {
            L.polyline(segmentCoords, {
              color: lineColors[linesOnSegment[j]],
              weight: lineWeight,
              opacity: 1,
              offset: j * (lineWeight + 1) - (segmentWidth / 2) + ((lineWeight + 1) / 2)
            }).addTo(busLines);
          }

          addStop(segmentCoords[0]);
          addStop(segmentCoords[segmentCoords.length - 1]);
        });

        ends.forEach(function(endCoords) {
          L.circleMarker(endCoords, {
            color: '#000',
            fillColor: '#ccc',
            fillOpacity: 1,
            radius: 10,
            weight: 4,
            opacity: 1
          }).addTo(busStops);
        });

        outlines.addTo(map);
        lineBg.addTo(map);
        busLines.addTo(map);
        busStops.addTo(map);
      }
    </script>
  </head>

  <body>
    <div id="map"></div>
  </body>
</html>
